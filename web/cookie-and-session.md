---
layout  : wiki
title   : 
summary : 
date    : 2022-08-23 20:42:25 +0900
updated : 2022-08-23 20:42:31 +0900
tags    : 
toc     : true
public  : true
parent  : 
latex   : false
---
* TOC
{:toc}

# 
##
###
- http 프로토콜 환경은 connectionless, stateless하다. 무슨 말이냐면, 클라이언트가 요청을 한 후 응답을 받으면 그 연결을 끊어 버리고(connectionless), 통신이 끝나면 상태를 유지하지 않는다(stateless)는 것이다.
- 이러한 http 프로토콜의 특징으로 인해 불편함이 생긴다. 온라인 스토어 사이트를 예를 들면, 로그인한 채로 A 상품 페이지를 보다가 B 상품 페이지를 보려고 페이지 이동을 하려면 로그인 정보가 유지되지 않아서 페이지를 옮겨다닐 때마다 로그인을 새로 해야한다. 이때 로그인 정보를 상태로 볼 수 있다. http는 로그인 정보와 같은 상태를 유지하지 않기 때문에 페이지가 바뀌면 로그인을 새로 해야 한다.
- 쿠키와 세션은 이러한 불편함을 해결하도록 도와준다.

## 쿠키
### 쿠키의 정의
- 클라이언트 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일

### 쿠키의 구성 요소
- 이름 : 각각의 쿠키를 구별하는 데 사용되는 이름
- 값 : 쿠키의 이름과 관련된 값
- 유효 기간 : 쿠키의 유지 시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 쿠키를 전송할 요청 경로

#### 쿠키의 유효 기간
- 브라우저는 서버에 요청할 때마다 쿠키를 보낸다. 유효시간은 얼마동안 그래야 할지 결정한다.
- 유효 기간이 적혀있지 않은 쿠키를 세션 쿠키(session cookie)라고 부르며, 브라우저 세션이 종료될 때(ex. 브라우저의 탭을 닫을 때) 쿠키도 함께 만료된다.
- 유효 기간이 적혀있는 쿠키를 영속 쿠키(permanent cookie)라고 부르며, 세션과는 관계 없이 설정한 유효 기간까지 유효하다.
- 유효 기간과 관련된 속성으로는 Expires, Max-Age가 있다. Expires는 종료 시점을, Max-Age는 유효 기간을 말한다.


### 쿠키의 동작 방식
1. 클라이언트가 페이지를 요청한다
2. 서버에서 쿠키를 생성한다
3. 서버는 Set-Cookie라는 응답 헤더에 브라우저가 수신해야 할 쿠키 정보를 넣어 응답한다
4. 클라이언트는 같은 요청을 할 경우 HTTP 헤더에 쿠키를 함께 보낸다
  + 클라이언트가 따로 설정하지 않아도 쿠키가 자동으로 포함된다
6. 서버에서 쿠키를 읽는다.
  + 서버는 쿠키 정보를 변경해야 하면 쿠키를 업데이트하고, 변경된 쿠키를 HTTP 헤더에 포함해 응답한다.
  + 쿠키 만료 기간이 있다면 브라우저가 종료되어도 클라이언트에서 쿠키를 보관하고 있는다.

## 세션
### 세션의 정의
- 동일한 브라우저로부터 들어오는 일련의 요구를 하나의 상태로 보고, 그 상태를 일정 시간 유지시키는 기술
- 여기서 일정 시간은 방문자가 웹 브라우저를 통해 웹 서버에 접속한 시점으로부터 웹 브라우저를 종료하여 연결을 끝내는 시점까지를 말한다

### 세션의 특징
- 쿠키를 기반으로 하지만, 서버 측에서 관리한다.
- 서버는 클라이언트를 구분하기 위해 세션 아이디를 부여하며 브라우저가 서버에 접속해서 브라우저를 종료할 때까지 인증상태를 유지한다.
  + 세션 아이디는 클라이언트가 요청을 보내면 서버가 클라이언트에게 부여하는 유일한 아이디를 말한다.

### 세션의 동작 방식
1. 클라이언트가 서버에 페이지를 요청한다.
2. 서버는 요청 헤더 안 쿠키에 세션 아이디가 있는지 확인한다.
  + 세션 아이디가 없다면 서버는 세션 아이디를 생성해 클라이언트에게 준다.
3. 클라이언트는 쿠키를 사용해서 세션 아이디를 저장한다.
4. 클라이언트는 이후 서버에 요청할 때, 이 쿠키의 세션 아이디를 같이 서버에 전달한다.
4. 서버는 세션 아이디를 받아 별다른 작업없이 세션 아이디로 세션에 있는 클라이언트 정보를 찾아와서 사용한다.
5. 서버는 클라이언트 정보를 가지고 서버 요청을 처리하여 클라이언트에게 응답한다.

## 참고 자료
- https://interconnection.tistory.com/74
- https://www.daleseo.com/http-cookies/
- https://www.daleseo.com/http-session/
- https://www.youtube.com/watch?v=-4ZsGy1LOiE&ab_channel=%EC%9A%B0%EC%95%84%ED%95%9CTech
